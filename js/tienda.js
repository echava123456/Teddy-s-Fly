}
{
  id: "233pm-15.4-minions-guitarra",
  nombre: "Minions guitarra 25 cm",
  precio: 26000,
  imagen: "imagenes/personajes/minions-guitarra.jpg",
  descripcionCorta: "Peluche Minion guitarra de 25 cm. Un personaje en versión musical y divertida.",
  categoria: "personajes"
},
{
  id: "233pm-15.4-minions-oso",
  nombre: "Minions guitarra OSO 25 cm",
  precio: 26000,
  imagen: "imagenes/personajes/minions-oso.jpg",
  descripcionCorta: "Peluche Minion guitarra con oso de 25 cm. Un diseño tierno y original.",
  categoria: "personajes"
},
{
  id: "Cj-1455-15.6-carl",
  nombre: "Viejitos ancheta Carl 20 cm",
  precio: 26500,
  imagen: "imagenes/personajes/viejitos-carl.jpg",
  descripcionCorta: "Peluche Viejitos ancheta Carl de 20 cm, inspirado en personajes entrañables.",
  categoria: "personajes"
},
{
  id: "Mt03-3-15.9-unicornio-rosa",
  nombre: "Unicornio Corazon 25cm ROSA",
  precio: 27000,
  imagen: "imagenes/personajes/unicornio-corazon-rosa.jpg",
  descripcionCorta: "Peluche unicornio con corazón, color rosa, de 25cm. Un regalo mágico.",
  categoria: "personajes"
},
{
  id: "Mt03-3-15.9-unicornio-blanco",
  nombre: "Unicornio Corazon 25cm BLANCO",
  precio: 27000,
  imagen: "imagenes/personajes/unicornio-corazon-blanco.jpg",
  descripcionCorta: "Peluche unicornio con corazón, color blanco, de 25cm. Perfecto para regalar.",
  categoria: "personajes"
},
{
  id: "JE-18-16.2-garfieldbebe",
  nombre: "Garfield Bebe 20cm",
  precio: 27500,
  imagen: "imagenes/personajes/garfield-bebe.jpg",
  descripcionCorta: "Peluche Garfield bebé de 20 cm, ideal para fans del gato más famoso.",
  categoria: "personajes"
},
{
  id: "22-57-17.9-cojin-mario",
  nombre: "Cojin cara de MARIO 30x30 cm",
  precio: 30000,
  imagen: "imagenes/personajes/cojin-mario.jpg",
  descripcionCorta: "Cojín de peluche con la cara de Mario Bros, tamaño 30x30 cm. Ideal para gamers.",
  categoria: "personajes"
},
{
  id: "Sur05-30-18.9-buzz",
  nombre: "Peluche elástico mediano 30cm BUZZ",
  precio: 32000,
  imagen: "imagenes/personajes/buzz.jpg",
  descripcionCorta: "Peluche elástico de Buzz Lightyear, tamaño mediano de 30cm. ¡Hasta el infinito y más allá!",
  categoria: "personajes"
},
{
  id: "Sur05-30-18.9-marciano",
  nombre: "Peluche elástico mediano 30cm MARCIANO",
  precio: 32000,
  imagen: "imagenes/personajes/marciano.jpg",
  descripcionCorta: "Peluche elástico de Marciano, tamaño mediano de 30cm, divertido y suave. Inspirado en Toy Story.",
  categoria: "personajes"
},
{
  id: "JE-03-20.2-circo-conejo",
  nombre: "Circo Digital 28cm CONEJO",
  precio: 34000,
  imagen: "imagenes/personajes/circo-conejo.jpg",
  descripcionCorta: "Peluche conejo del Circo Digital, tamaño 28 cm. Un personaje tierno.",
  categoria: "personajes"
},
{
  id: "JE-03-20.2-circo-payasos",
  nombre: "Circo Digital 28cm PAYASO",
  precio: 34000,
  imagen: "imagenes/personajes/circo-payasos.jpg",
  descripcionCorta: "Peluche payaso del Circo Digital, tamaño 28 cm. Colores vivos y diseño alegre.",
  categoria: "personajes"
},
{
  id: "1879-20.8-virgencita-blanca",
  nombre: "Virgencita 30 cm BLANCA",
  precio: 35000,
  imagen: "imagenes/personajes/virgencita-blanca.jpg",
  descripcionCorta: "Peluche Virgencita color blanco, tamaño 30 cm. Un regalo espiritual y tierno.",
  categoria: "personajes"
},
{
  id: "1879-20.8-virgencita-azul",
  nombre: "Virgencita 30 cm AZUL",
  precio: 35000,
  imagen: "imagenes/personajes/virgencita-azul.jpg",
  descripcionCorta: "Peluche Virgencita color azul, tamaño 30 cm. Suave y especial.",
  categoria: "personajes"
},
{
  id: "Cj-3918-21-sonic-rosa",
  nombre: "Sonic mediano y amigos 25 cm ROSA",
  precio: 35500,
  imagen: "imagenes/personajes/sonic-rosa.jpg",
  descripcionCorta: "Peluche Sonic mediano y amigos, versión rosa, 25 cm. Ideal para coleccionistas.",
  categoria: "personajes"
},
{
  id: "je-02-21.5-smiling-rosado",
  nombre: "Smiling colores 25 cm ROSADO",
  precio: 36000,
  imagen: "imagenes/personajes/smiling-rosado.jpg",
  descripcionCorta: "Peluche Smiling color rosado de 25 cm, diseño alegre y suave.",
  categoria: "personajes"
},
{
  id: "je-02-21.5-smiling-amarillo",
  nombre: "Smiling colores 25 cm AMARILLO",
  precio: 36000,
  imagen: "imagenes/personajes/smiling-amarillo.jpg",
  descripcionCorta: "Peluche Smiling color amarillo de 25 cm, brilla con alegría.",
  categoria: "personajes"
},
{
  id: "10-11-21.5-sullivan",
  nombre: "Sullivan Camisa 30 cm",
  precio: 36000,
  imagen: "imagenes/personajes/sullivan.jpg",
  descripcionCorta: "Peluche Sullivan con camisa, tamaño 30 cm. Inspirado en Monsters Inc.",
  categoria: "personajes"
},
{
  id: "JE-49-22.5-babyyoda",
  nombre: "Baby Yoda 35 cm",
  precio: 38000,
  imagen: "imagenes/personajes/babyyoda.jpg",
  descripcionCorta: "Peluche Baby Yoda de 35 cm, tierno y adorable. Fans de Star Wars.",
  categoria: "personajes"
},
{
  id: "1881-22.9-raton2",
  nombre: "Raton #2 30 cm",
  precio: 38500,
  imagen: "imagenes/personajes/raton2.jpg",
  descripcionCorta: "Peluche Raton #2 de 30 cm, para niños o decorar su espacio favorito.",
  categoria: "personajes"
},
{
  id: "1934-25.9-kuromi-grande",
  nombre: "Kuromi 20 cm",
  precio: 44000,
  imagen: "imagenes/personajes/kuromi-grande.jpg",
  descripcionCorta: "Peluche Kuromi de 20 cm, la traviesa amiga de My Melody. Fans de Sanrio.",
  categoria: "personajes"
},
{
  id: "1864-26.9-bob33",
  nombre: "Bob Esponja 33 cm",
  precio: 45500,
  imagen: "imagenes/personajes/bob33.jpg",
  descripcionCorta: "Peluche Bob Esponja de 33 cm, el personaje más divertido de Fondo de Bikini. Abrazable y suave.",
  categoria: "personajes"
},
{
  id: "2019p-26.9-mascota-nacional",
  nombre: "Mascota Nacional 30 cm",
  precio: 45500,
  imagen: "imagenes/personajes/mascota-nacional.jpg",
  descripcionCorta: "Peluche Mascota Nacional de 30 cm, símbolo de alegría y unión. Perfecto para regalar a cualquier edad.",
  categoria: "personajes"
},
{
  id: "1864-26.9-patricio33",
  nombre: "Patricio 33 cm",
  precio: 45500,
  imagen: "imagenes/personajes/patricio33.jpg",
  descripcionCorta: "Peluche Patricio estrella de mar, amigo de Bob Esponja, tamaño 33 cm. Suave y divertido para todos.",
  categoria: "personajes"
},
{
  id: "JE-56-28-zootopia-zorro",
  nombre: "Zootopia 35cm ZORRO",
  precio: 47000,
  imagen: "imagenes/personajes/zootopia-zorro.jpg",
  descripcionCorta: "Peluche Zorro de Zootopia, tamaño 35 cm. Ideal para aventuras y juegos imaginativos.",
  categoria: "personajes"
},
{
  id: "JE-56-28-zootopia-conejo",
  nombre: "Zootopia 35cm CONEJO",
  precio: 47000,
  imagen: "imagenes/personajes/zootopia-conejo.jpg",
  descripcionCorta: "Peluche Conejo de Zootopia, tamaño 35 cm. Suave, tierno y con detalles de gran calidad.",
  categoria: "personajes"
},
{
  id: "xh-35-29.5-ratones-rosa",
  nombre: "Ratones pijama 35cm ROSA",
  precio: 50000,
  imagen: "imagenes/personajes/ratones-pijama-rosa.jpg",
  descripcionCorta: "Peluche ratón con pijama color rosa, tamaño 35 cm. Detalles adorables y perfecto para dormir acompañado.",
  categoria: "personajes"
},
{
  id: "1839-31.9-viejita-mediana",
  nombre: "Viejita Cuerpo entero Mediana 28 cms",
  precio: 54000,
  imagen: "imagenes/personajes/viejita-mediana.jpg",
  descripcionCorta: "Peluche Viejita cuerpo entero, tamaño mediana de 28 cm. Un personaje dulce y especial para regalar.",
  categoria: "personajes"
},
{
  id: "1940-31.9-luigi",
  nombre: "Personajes LUIGI 30 Cms",
  precio: 54000,
  imagen: "imagenes/personajes/luigi.jpg",
  descripcionCorta: "Peluche Luigi de 30 cm, el inseparable hermano de Mario Bros. Un clásico para gamers y coleccionistas.",
  categoria: "personajes"
},
{
  id: "1940-31.9-peach",
  nombre: "Personajes PRINCESA PEACH 30 Cms",
  precio: 54000,
  imagen: "imagenes/personajes/peach.jpg",
  descripcionCorta: "Peluche Princesa Peach de 30 cm, la princesa favorita de los videojuegos. Suave y elegante.",
  categoria: "personajes"
},
{
  id: "1940-31.9-toad",
  nombre: "Personajes TOAD 30 Cms",
  precio: 54000,
  imagen: "imagenes/personajes/toad.jpg",
  descripcionCorta: "Peluche Toad de 30 cm, el amigo fiel de Mario y Luigi. Ideal para decorar o jugar.",
  categoria: "personajes"
},
{
  id: "1882-32.5-raton3",
  nombre: "Raton #3 40 cm",
  precio: 55000,
  imagen: "imagenes/personajes/raton3.jpg",
  descripcionCorta: "Peluche Raton #3 de 40 cm, tamaño grande y suave. Ideal para abrazar y acompañar en el descanso.",
  categoria: "personajes"
},
{
  id: "JE-25-34.9-stitch-panda",
  nombre: "Stitch disfraz panda 35cm",
  precio: 59000,
  imagen: "imagenes/personajes/stitch-panda.jpg",
  descripcionCorta: "Peluche Stitch disfrazado de panda, tamaño 35 cm. Diseño adorable y divertido para fans de Disney.",
  categoria: "personajes"
},
{
  id: "1964-39.9-envidia",
  nombre: "Personajes Intensamente ENVIDIA 30 cm",
  precio: 62500,
  imagen: "imagenes/personajes/envidia.jpg",
  descripcionCorta: "Peluche Envidia de Intensamente, tamaño 30 cm. Completa tu colección de emociones.",
  categoria: "personajes"
},
{
  id: "1840-37.9-viejito-mediano",
  nombre: "Viejito Cuerpo entero Mediano 30 cm",
  precio: 64000,
  imagen: "imagenes/personajes/viejito-mediano.jpg",
  descripcionCorta: "Peluche Viejito cuerpo entero mediano, tamaño 30 cm. Un personaje simpático y entrañable.",
  categoria: "personajes"
},
{
  id: "1980-39.8-lilo-stitch",
  nombre: "Lilo Y Stitch 40cm",
  precio: 67500,
  imagen: "imagenes/personajes/lilo-stitch.jpg",
  descripcionCorta: "Peluche Lilo y Stitch juntos, tamaño 40 cm. Un dúo inseparable para los fans de Disney.",
  categoria: "personajes"
},
// {
//   id: "1974-42.5-kuromi-grande",
//   nombre: "Kuromi Grande 40cm",
//   precio: 70500,
//   imagen: "imagenes/personajes/kuromi-grande2.jpg",
//   descripcionCorta: "Peluche Kuromi grande de 40 cm, edición especial para fans de Sanrio.",
//   categoria: "personajes"
// },
// {
//   id: "50PU-46.0-unicornio-estrellas",
//   nombre: "Unicornio Estrellas Bordado 45cm",
//   precio: 70500,
//   imagen: "imagenes/personajes/unicornio-estrellas.jpg",
//   descripcionCorta: "Peluche unicornio estrellas de 45 cm, bordado y brillante. Un regalo mágico para cualquier edad.",
//   categoria: "personajes"
// },
// {
//   id: "MT-111-44.5-stitch-sonriente",
//   nombre: "Stitch Sonriente 40cm",
//   precio: 75500,
//   imagen: "imagenes/personajes/stitch-sonriente.jpg",
//   descripcionCorta: "Peluche Stitch sonriente de 40 cm. Perfecto para abrazar y sonreír junto a él.",
//   categoria: "personajes"
// },
// // {
//   id: "JE-16-45.0-gata-fresa",
//   nombre: "Gata con fresa 30cm",
//   precio: 76500,
//   imagen: "imagenes/personajes/gata-fresa.jpg",
//   descripcionCorta: "Peluche gata con fresa, tamaño 30 cm. Diseño original y tierno.",
//   categoria: "personajes"
// },
// {
//   id: "1883-51.4-raton4",
//   nombre: "Raton #4 50 cm",
//   precio: 87000,
//   imagen: "imagenes/personajes/raton4.jpg",
//   descripcionCorta: "Peluche Raton #4 tamaño gigante de 50 cm. Súper suave y abrazable.",
//   categoria: "personajes"
// },
// {
//   id: "2502-53.9-stitch-audifonos",
//   nombre: "Stitch con audifonos 40cm",
//   precio: 91000,
//   imagen: "imagenes/personajes/stitch-audifonos.jpg",
//   descripcionCorta: "Peluche Stitch con audífonos, tamaño 40 cm. Para los fans de la música.",
//   categoria: "personajes"
// }
// {
//   id: "1837-66.5-viejita-grande",
//   nombre: "Viejita cuerpo entero Grande 50 cms",
//   precio: 113500,
//   imagen: "imagenes/personajes/viejita-grande.jpg",
//   descripcionCorta: "Peluche Viejita cuerpo entero tamaño grande de 50 cm. Ideal para decorar o regalar.",
//   categoria: "personajes"
// },
// {
//   id: "1838-77.5-viejito-grande",
//   nombre: "Viejito Cuerpo entero Grande 50 cms v",
//   precio: 131500,
//   imagen: "imagenes/personajes/viejito-grande.jpg",
//   descripcionCorta: "Peluche Viejito cuerpo entero tamaño grande de 50 cm. Perfecto para acompañar o decorar.",
//   categoria: "personajes"
// },
// {
//   id: "1884-82.9-raton5",
//   nombre: "Ratón #5 95 cms",
//   precio: 140500,
//   imagen: "imagenes/personajes/raton5.jpg",
//   descripcionCorta: "Peluche Ratón #5 tamaño extra grande de 95 cm. El peluche más grande y abrazable.",
//   categoria: "personajes"
// },
// {
//   id: "1878-122-ratona-extra",
//   nombre: "Ratona Extra Gigante #6 120 Cms",
//   precio: 207500,
//   imagen: "imagenes/personajes/ratona-extra.jpg",
//   descripcionCorta: "Peluche Ratona Extra Gigante #6 de 120 cm. Un peluche espectacular para abrazos gigantes.",
//   categoria: "personajes"
// }

//   ];

// const variedades = [
//   {
//     id: "srb-135-lata-carino-17",
//     nombre: "SRB| 13.5 Simpson Roll Lata CON CARIÑO 17 cm",
//     precio: 22500,
//     imagen: "imagenes/variedades/srb-135-lata-carino-17.jpg",
//     descripcionCorta: "Simpson Roll presentado en lata con el mensaje 'CON CARIÑO'. Tamaño: 17 cm. Ideal para regalar y sorprender.",
//     categoria: "variedades"
//   },
//   {
//     id: "srb-135-lata-felizdia-17",
//     nombre: "SRB| 13.5 Simpson Roll Lata FELIZ DIA 17 cm",
//     precio: 22500,
//     imagen: "imagenes/variedades/srb-135-lata-felizdia-17.jpg",
//     descripcionCorta: "Simpson Roll en lata con el mensaje 'FELIZ DIA'. Tamaño de 17 cm. Un detalle especial para ocasiones felices.",
//     categoria: "variedades"
//   },
//   {
//     id: "srb-135-botella-parati-24",
//     nombre: "SRB| 13.5 Simpson Roll Botella PARA TI 24 cm",
//     precio: 22500,
//     imagen: "imagenes/variedades/srb-135-botella-parati-24.jpg",
//     descripcionCorta: "Simpson Roll en botella con el mensaje 'PARA TI'. Tamaño: 24 cm. Perfecto para regalos personalizados.",
//     categoria: "variedades"
//   },
//   {
//     id: "srb-135-lata-felicidades-17",
//     nombre: "SRB| 13.5 Simpson Roll Lata FELICIDADES EN TU DIA 17 cm",
//     precio: 22500,
//     imagen: "imagenes/variedades/srb-135-lata-felicidadesentu-17.jpg",
//     descripcionCorta: "Simpson Roll en lata con el mensaje 'FELICIDADES EN TU DIA'. Tamaño: 17 cm. Un regalo ideal para celebrar.",
//     categoria: "variedades"
//   },
//   {
//     id: "srb-135-lata-parati-felizdia-17",
//     nombre: "SRB| 13.5 Simpson Roll Lata PARA TI FELIZ DIA 17 cm",
//     precio: 22500,
//     imagen: "imagenes/variedades/srb-135-lata-paratifelizdia-17.jpg",
//     descripcionCorta: "Simpson Roll en lata con mensaje 'PARA TI FELIZ DIA'. Tamaño: 17 cm. Un detalle único.",
//     categoria: "variedades"
//   },
//   {
//     id: "srb-135-botella-felicidades-24",
//     nombre: "SRB| 13.5 Simpson Roll Botella FELICIDADES 24 cm",
//     precio: 22500,
//     imagen: "imagenes/variedades/srb-135-botella-felicidades-24.jpg",
//     descripcionCorta: "Simpson Roll en botella con el mensaje 'FELICIDADES'. Tamaño: 24 cm. Perfecto para celebraciones.",
//     categoria: "variedades"
//   },
//   {
//     id: "srb-135-botella-milfelicidades-24",
//     nombre: "SRB| 13.5 Simpson Roll Botella MIL FELICIDADES 24 cm",
//     precio: 22500,
//     imagen: "imagenes/variedades/srb-135-botella-milfelicidades-24.jpg",
//     descripcionCorta: "Simpson Roll en botella con el mensaje 'MIL FELICIDADES'. Tamaño: 24 cm. Regalo ideal para felicitar.",
//     categoria: "variedades"
//   },
//   {
//     id: "srb-135-botella-entudia-24",
//     nombre: "SRB| 13.5 Simpson Roll Botella EN TU DIA 24 cm",
//     precio: 22500,
//     imagen: "imagenes/variedades/srb-135-botella-entudia-24.jpg",
//     descripcionCorta: "Simpson Roll en botella con el mensaje 'EN TU DIA'. Tamaño: 24 cm. Perfecto para cualquier celebración.",
//     categoria: "variedades"
//   },
//   {
//     id: "bsb-89-beer-homero-29",
//     nombre: "BSB|8.9 Cerveza beer simpsons HOMERO FELIZ DIA 7.5x7x29 cms",
//     precio: 15000,
//     imagen: "imagenes/variedades/bsb-89-beer-homero-29.jpg",
//     descripcionCorta: "Cerveza de peluche estilo Simpsons, personaje Homero con mensaje 'FELIZ DIA'. Tamaño: 7.5x7x29 cm.",
//     categoria: "variedades"
//   },
//   {
//     id: "bsb-89-beer-duffman-29",
//     nombre: "BSB|8.9 Cerveza beer simpsons DUFFMAN ESPECIAMENTE PARA TI 7.5x7x29 cms",
//     precio: 15000,
//     imagen: "imagenes/variedades/bsb-89-beer-duffman-29.jpg",
//     descripcionCorta: "Cerveza de peluche estilo Simpsons, personaje DuffMan con mensaje 'ESPECIAMENTE PARA TI'. Tamaño: 7.5x7x29 cm.",
//     categoria: "variedades"
//   },
//   {
//     id: "bsb-88-beer-bart-29",
//     nombre: "BSB|8.8 Cerveza beer simpsons BART: FELIZ CUMPLE 7.5x7x29 cms",
//     precio: 14500,
//     imagen: "imagenes/variedades/bsb-88-beer-bart-29.jpg",
//     descripcionCorta: "Cerveza de peluche estilo Simpsons, personaje Bart con mensaje 'FELIZ CUMPLE'. Tamaño: 7.5x7x29 cm.",
//     categoria: "variedades"
//   },
//   {
//     id: "bsb-88-beer-nelson-29",
//     nombre: "BSB|8.8 Cerveza beer simpsons NELSON: CON CARIÑO PARA TI 7.5x7x29 cms",
//     precio: 14500,
//     imagen: "imagenes/variedades/bsb-88-beer-nelson-29.jpg",
//     descripcionCorta: "Cerveza de peluche estilo Simpsons, personaje Nelson con mensaje 'CON CARIÑO PARA TI'. Tamaño: 7.5x7x29 cm.",
//     categoria: "variedades"
//   },
//   {
//     id: "5161-32-splash-vct-60ml",
//     nombre: "5161| 3.2 Splash 60ml Vct",
//     precio: 5500,
//     imagen: "imagenes/5161-1536x1536.jpeg",
//     descripcionCorta: "Splash Vct de 60ml, ideal para refrescarte en cualquier momento. Presentación pequeña y práctica.",
//     categoria: "variedades"
//   },
//   {
//     id: "1278-87-splash-vct-250ml-dorada",
//     nombre: "1278|8.7 Splash Vct tapa dorada 250ml SURTIDO",
//     precio: 14500,
//     imagen: "imagenes/tapa-dorada-.jpg",
//     descripcionCorta: "Splash Vct de 250ml con tapa dorada. Fragancias surtidas para todos los gustos.",
//     categoria: "variedades"
//   },
//   {
//     id: "1819-47-splash-vct-125ml",
//     nombre: "1819|4.7 Splash Vct 125ml SURTIDO",
//     precio: 7500,
//     imagen: "imagenes/splash-250.jpg",
//     descripcionCorta: "Splash Vct de 125ml, fragancias surtidas. Una excelente opción para el día a día.",
//     categoria: "variedades"
//   },
//   {
//     id: "1317-79-splash-pk-250ml",
//     nombre: "1317|7.9 Splash Pk 250ml SURTIDO",
//     precio: 13000,
//     imagen: "imagenes/pink-250.jpg",
//     descripcionCorta: "Splash Pk de 250ml, fragancias surtidas. Disfruta de aromas frescos y duraderos.",
//     categoria: "variedades"
//   },
//   {
//     id: "1186-47-splash-mini-pk-75ml",
//     nombre: "1186|4.7 Splash mini Pk 75ml SURTIDO",
//     precio: 7500,
//     imagen: "imagenes/mini-pink-75.jpg",
//     descripcionCorta: "Splash mini Pk de 75ml, fragancias surtidas. Práctico para llevar en el bolso o mochila.",
//     categoria: "variedades"
//   }
// ];

// ---- Renderizado por sección ----
function renderProductos(lista, gridId) {
    const grid = document.getElementById(gridId);
    grid.innerHTML = "";
    if (!lista.length) {
        grid.innerHTML = "<p>No se encontraron productos.</p>";
        return;
    }
    lista.forEach(producto => {
        grid.innerHTML += `
        <div class="producto-card">
            <img src="${producto.imagen}" alt="${producto.nombre}">
            <h3>${producto.nombre}</h3>
            <p class="precio">$${producto.precio.toLocaleString('es-CO')}</p>
            <a href="detalle-producto.html?id=${producto.id}" class="btn-secondary">Ver Detalles</a>
            <button class="btn-cart"
                data-id="${producto.id}"
                data-nombre="${producto.nombre}"
                data-precio="${producto.precio}"
                data-imagen="${producto.imagen}"
                title="Añadir al carrito">
                <img src="assets/icons/cart.svg" alt="Añadir al carrito">
            </button>
        </div>
        `;
    });
}

// ---- Carrito ----
document.addEventListener("click", function(e) {
    const btn = e.target.closest(".btn-cart");
    if (btn) {
        const id = btn.getAttribute("data-id");
        const nombre = btn.getAttribute("data-nombre");
        const precio = parseInt(btn.getAttribute("data-precio"));
        const imagen = btn.getAttribute("data-imagen");
        let carrito = JSON.parse(localStorage.getItem("carrito")) || [];
        const item = carrito.find(p => p.id === id);
        if (item) {
            item.cantidad += 1;
        } else {
            carrito.push({ id, nombre, precio, imagen, cantidad: 1 });
        }
        localStorage.setItem("carrito", JSON.stringify(carrito));
        // Actualiza el contador visual (total unidades en el carrito)
        const cartCount = document.querySelector('.cart-count');
        if (cartCount) {
            let totalUnidades = carrito.reduce((sum, prod) => sum + prod.cantidad, 0);
            cartCount.textContent = totalUnidades;
        }
        alert('Producto añadido al carrito');
    }
});

// ---- Buscador Global ----
const inputBusqueda = document.getElementById('busqueda-productos');
const formBusqueda = document.querySelector('.search-form');

// Si no existe alguna sección, que sea array vacío
const personajesArray = typeof personajes !== "undefined" ? personajes : [];
const peluchesArray = typeof peluches !== "undefined" ? peluches : [];
const variedadesArray = typeof variedades !== "undefined" ? variedades : [];

// --- Filtrar productos ocultos (eliminados desde el panel admin localmente) ---
let productosOcultos = JSON.parse(localStorage.getItem("productosOcultos")) || [];

function filtraOcultos(arr) {
    return arr.filter(p => !productosOcultos.includes(p.id));
}

// Función para renderizar y filtrar según la categoría
function inicializarVista(personajesArr, peluchesArr, variedadesArr) {
    // Actualiza contador carrito al cargar
    const carrito = JSON.parse(localStorage.getItem("carrito")) || [];
    const cartCount = document.querySelector('.cart-count');
    if (cartCount) {
        let totalUnidades = carrito.reduce((sum, prod) => sum + prod.cantidad, 0);
        cartCount.textContent = totalUnidades;
    }

    // Mostrar por categoría
    const cat = getCategoriaURL();

    if (cat === "personajes") {
        renderProductos(personajesArr, "grid-personajes");
        document.getElementById("seccion-personajes").style.display = "";
        document.getElementById("seccion-peluches").style.display = "none";
        document.getElementById("seccion-variedades").style.display = "none";
        document.getElementById("seccion-personajes").scrollIntoView({behavior: "smooth"});
    } else if (cat === "peluches") {
        renderProductos(peluchesArr, "grid-peluches");
        document.getElementById("seccion-personajes").style.display = "none";
        document.getElementById("seccion-peluches").style.display = "";
        document.getElementById("seccion-variedades").style.display = "none";
        document.getElementById("seccion-peluches").scrollIntoView({behavior: "smooth"});
    } else if (cat === "variedades") {
        renderProductos(variedadesArr, "grid-variedades");
        document.getElementById("seccion-personajes").style.display = "none";
        document.getElementById("seccion-peluches").style.display = "none";
        document.getElementById("seccion-variedades").style.display = "";
        document.getElementById("seccion-variedades").scrollIntoView({behavior: "smooth"});
    } else {
        document.getElementById("seccion-personajes").style.display = "";
        document.getElementById("seccion-peluches").style.display = "";
        document.getElementById("seccion-variedades").style.display = "";
        renderProductos(personajesArr, "grid-personajes");
        renderProductos(peluchesArr, "grid-peluches");
        renderProductos(variedadesArr, "grid-variedades");
    }
}

// ---- Buscador adaptado ----
function filtrarProductos(texto, personajesArr, peluchesArr, variedadesArr) {
    texto = texto.trim().toLowerCase();
    // Une todos los productos para filtrar
    const productosTotales = [
        ...personajesArr,
        ...peluchesArr,
        ...variedadesArr
    ];
    const filtrados = productosTotales.filter(producto =>
        producto.nombre.toLowerCase().includes(texto) ||
        (producto.descripcionCorta && producto.descripcionCorta.toLowerCase().includes(texto)) ||
        (producto.descripcion && producto.descripcion.toLowerCase().includes(texto))
    );
    renderProductos(
        filtrados.filter(p => p.__seccion === "personajes"),
        "grid-personajes"
    );
    renderProductos(
        filtrados.filter(p => p.__seccion === "peluches"),
        "grid-peluches"
    );
    renderProductos(
        filtrados.filter(p => p.__seccion === "variedades"),
        "grid-variedades"
    );
}

// ---- Inicializar: MOSTRAR CATEGORÍA O TODO ----
function getCategoriaURL() {
  const params = new URLSearchParams(window.location.search);
  return params.get('cat');
}

// ---- CARGAR PRODUCTOS DE FIRESTORE + FIJOS ----
document.addEventListener("DOMContentLoaded", function() {
    // Copias de los arrays para combinar fijos y Firestore
    let personajesArrayFull = filtraOcultos(personajesArray.slice());
    let peluchesArrayFull = filtraOcultos(peluchesArray.slice());
    let variedadesArrayFull = filtraOcultos(variedadesArray.slice());

    // 1. Carga productos Firestore y agrégalos según categoría
    if (typeof db !== "undefined") {
        db.collection("productos").get().then((querySnapshot) => {
            querySnapshot.forEach((doc) => {
                const p = doc.data();
                // Usa el campo p.id (slug) si existe, si no, usa doc.id (compatibilidad productos viejos)
                const adaptado = {
                    ...p,
                    __seccion: p.categoria,
                    imagen: p.image,
                    nombre: p.name,
                    descripcion: p.detail || "",
                    precio: p.precio || 0,
                    id: p.id ? p.id : doc.id
                };
                if (p.categoria === "personajes") personajesArrayFull.push(adaptado);
                if (p.categoria === "peluches") peluchesArrayFull.push(adaptado);
                if (p.categoria === "variedades") variedadesArrayFull.push(adaptado);
            });

            // Ahora sí, renderiza con todos los productos (fijos + Firestore)
            inicializarVista(personajesArrayFull, peluchesArrayFull, variedadesArrayFull);

            // Buscador global con todos los productos
            if (formBusqueda && inputBusqueda) {
                formBusqueda.addEventListener('submit', function(e) {
                    e.preventDefault();
                    filtrarProductos(inputBusqueda.value, personajesArrayFull, peluchesArrayFull, variedadesArrayFull);
                });
                inputBusqueda.addEventListener('input', function() {
                    filtrarProductos(this.value, personajesArrayFull, peluchesArrayFull, variedadesArrayFull);
                });
            }
        });
    } else {
        // Si no hay db (por algún error), muestra solo los fijos
        inicializarVista(personajesArrayFull, peluchesArrayFull, variedadesArrayFull);
        if (formBusqueda && inputBusqueda) {
            formBusqueda.addEventListener('submit', function(e) {
                e.preventDefault();
                filtrarProductos(inputBusqueda.value, personajesArrayFull, peluchesArrayFull, variedadesArrayFull);
            });
            inputBusqueda.addEventListener('input', function() {
                filtrarProductos(this.value, personajesArrayFull, peluchesArrayFull, variedadesArrayFull);
            });
        }
    }
});
